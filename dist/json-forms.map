{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap b3b2d419db67b6327a7a","webpack:///./lib/json-forms.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,wC;;;;;;;ACtCA;;AAEA,SAAQ,UAAU,WAAW,WAAW,aAAa,aAAa;;AAElE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,MAAK;AACL;AACA;AACA;AACA;AACA,QAAO;AACP,MAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,IAAG;AACH,oBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL,sCAAqC,iCAAiC;;AAEtE,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,QAAO;AACP;AACA;AACA,IAAG;AACH,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB,kBAAkB;AACrC;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA,oBAAmB;;AAEnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,eAAc;AACd,MAAK;AACL;AACA;AACA,eAAc;AACd,MAAK;AACL;AACA,eAAc;AACd,MAAK;AACL,8BAA6B,eAAe;AAC5C;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,8DAA6D;AAC7D;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"JSONForms\"] = factory();\n\telse\n\t\troot[\"JSONForms\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap b3b2d419db67b6327a7a\n **/","'use strict';\n\nvar Gn={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#x27;\"}\n\nfunction isNumeric(value) {\n  return /^\\d+$/.test(value);\n}\n\nfunction parsePath(path) {\n  var originalPath = path;\n  var steps = [];\n  var error = false;\n  var firstKey = path.substr(0, path.indexOf('['));\n  if (!firstKey.length) {\n    error = true;\n  } else {\n    path = path.substr(path.indexOf('['), path.length);\n    steps.push({\n      key: firstKey,\n      last: !path.length,\n      type:'object'\n    });\n  }\n\n  var key;\n  key = path.substr(1, path.indexOf(']')-1);\n\n  while (path.length && !error) {\n    if (path[0] === '[' && path[1] === ']') {\n      steps.push({\n        append: true,\n        type: 'array'\n      });\n      path = path.substr(2, path.length);\n      error = path.length !== 0;\n    } else if (isNumeric(key = path.substr(1, path.indexOf(']')-1))) {\n      key = parseInt(key, 10);\n      path = path.substr(path.indexOf(']')+1, path.length);\n      steps.push({\n        key: key,\n        type: 'array'\n      })\n    } else if ((key = path.substr(1, path.indexOf(']')-1)) && key.indexOf('[') === -1) {\n      path = path.substr(path.indexOf(']')+1, path.length);\n      steps.push({\n        key: key,\n        type: 'object'\n      });\n    } else {\n      error = true;\n    }\n  }\n\n  if (error) {\n    steps = [{\n      key: originalPath,\n      last: true,\n      type: 'object'\n    }];\n  } else {\n    for (var i = 0; i < steps.length; i++) {\n      var step = steps[i];\n      var nextStep = steps[i+1];\n      if (nextStep) {\n        step.nextType = nextStep.type;\n      } else {\n        step.last = true;\n      }\n    }\n  }\n\n  return steps;\n}\n\nfunction setValue(context, step, currentValue, entryValue, isFile) {\n  if (isFile) {\n    entryValue = {\n      name: 'filename',\n      type: 'filetype',\n      body: 'filebody'\n    }\n  }\n  if (step.last) {\n    if (typeof currentValue === 'undefined') {\n      if (step.append) {\n        context.push(entryValue);\n      } else {\n        context[step.key] = entryValue;\n      }\n    } else if (currentValue.constructor == Array) {\n      context[step.key].push(entryValue);\n    } else if (currentValue.constructor == Object && !isFile) {\n      return setValue(currentValue, {key:'', last:true, type:'object'}, currentValue[''], entryValue, isFile);\n\n    } else {\n      context[step.key] = [currentValue, entryValue];\n    }\n    return context;\n  }\n\n  if (typeof currentValue === 'undefined') {\n    if (step.nextType === 'array') {\n      context[step.key] = [];\n    } else {\n      context[step.key] = {};\n    }\n    return context[step.key];\n  } else if (currentValue.constructor === Object) {\n    return context[step.key];\n  } else if (currentValue.constructor === Array) {\n    if (step.nextType === 'array') {\n      return currentValue;\n    } else {\n      var object = {};\n      currentValue.forEach(function(item, i) {\n        if (typeof item !== 'undefined') {\n          object[i] = item;\n        } else {\n          context[step.key] = object;\n        }\n      });\n      return object;\n    }\n  } else {\n    var object = {'': currentValue};\n    context[step.key] = object;\n    return object;\n  }\n}\n\nfunction JSONEncode(formEl) {\n  var entries = collectEntries(formEl);\n  var resultingObject = {};\n\n  entries.forEach(function(entry) {\n    var isFile = entry.value && entry.value.body !== undefined;\n    var steps = parsePath(entry.name);\n    var context = resultingObject;\n    for (var i = 0; i < steps.length; i++) {\n      var step = steps[i];\n      var currentValue = context[step.key];\n      context = setValue(context, step, currentValue, entry.value, isFile);\n    }\n  });\n\n  return resultingObject;\n}\n\nfunction collectEntries(formEl) {\n  return []\n    // input elements\n    .concat(Array.prototype.slice.call(formEl.querySelectorAll('input:not([type=submit])')).map(function(el) {\n      var entry = { name: el.name, value: el.value };\n\n      switch (el.type) {\n        case 'checkbox':\n          entry.value = el.checked\n          break;\n        case 'number':\n          entry.value = parseInt(el.value, 10);\n          break;\n        case 'radio':\n          if (el.checked)\n            entry.value === el.value;\n          else\n            return null;\n          break;\n      }\n      return entry;\n    }))\n    // select elements\n    .concat(Array.prototype.slice.call(formEl.querySelectorAll('select:not([multiple])')).map(function(el) {\n      return { name: el.name, value: el.value };\n    }))\n    .concat(Array.prototype.slice.call(formEl.querySelectorAll('select[multiple] option[selected]')).map(function(el) {\n      var selectEl = parent(el, 'select');\n      return { name: selectEl.name, value: el.value };\n    }))\n    .concat(Array.prototype.slice.call(formEl.querySelectorAll('textarea')).map(function(el) {\n      return { name: el.name, value: el.value };\n    }))\n    .filter(function(entry) { return entry;});\n};\n\nfunction parent(el, tagName) {\n  tagName = tagName.toLowerCase();\n\n  while (el && el.parentNode) {\n    el = el.parentNode;\n    if (el.tagName && el.tagName.toLowerCase() == tagName) {\n      return el;\n    }\n  }\n  return null;\n}\n\nfunction JSONFormSubmitHandler(e) {\n  var data;\n  var el = e.target;\n  var request;\n\n  if (el.tagName !== 'FORM' || el.getAttribute('enctype') !== 'application/json') return;\n\n  e.preventDefault();\n\n  data = JSON.stringify(JSONEncode(el));\n  request = new XMLHttpRequest();\n  request.open('POST', el.action);\n  request.setRequestHeader('Content-Type', 'application/json; charset=utf-8');\n  request.send(data);\n  request.onload = function() {\n    if (request.status > 200 && request.status < 400) {\n      console.log('success :)');\n    } else {\n      console.log('failure :(');\n    }\n  }\n}\n\nmodule.exports = {\n  enable: function() {\n    addEventListener('submit', JSONFormSubmitHandler);\n  },\n  encode: JSONEncode,\n  disable: function() {\n    removeEventListener('submit', JSONFormSubmitHandler);\n  }\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./lib/json-forms.js\n ** module id = 0\n ** module chunks = 0\n **/"],"sourceRoot":"","file":"./dist/json-forms.js"}